define(['underscore','jquery'],function(_,$){'use strict';function formatTemplatePath(path){return'text!'+path.replace(/^([^\/]+)/g,'$1/template')+'.html';}
function removeLicense(tmpl){var regEx=/<!--[\s\S]*?-->/;return tmpl.replace(regEx,function(match){return~match.indexOf('/**')?'':match;});}
function load(path,promise){require([path],function(template){template=removeLicense(template);promise.resolve(template);});}
return{loadTemplate:function(source){var isLoaded=$.Deferred();this._loadTemplate(source).done(function(tmpl){isLoaded.resolve(tmpl);});return isLoaded.promise();},_loadTemplate:function(name){var isLoaded=$.Deferred(),path=formatTemplatePath(name);load(path,isLoaded);return isLoaded.promise();}};});